<div class="p-8 bg-linear-to-br from-emerald-50 via-white to-teal-50 min-h-screen space-y-10">
    <!-- Page Header -->
    <div class="flex flex-col gap-1">
        <h1 class="text-3xl font-bold text-gray-800">Purchases</h1>
        <p class="text-gray-500">Track and manage all purchase records</p>
    </div>

    <!-- Top Actions -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="flex gap-3">
            <select class="px-4 py-2 rounded-xl bg-white shadow text-gray-700 border border-gray-200">
                <option>Filter by Supplier</option>
                @for (item of suppliers; track $index) {
                <option>{{item.name}}</option>
                }
            </select>

            <select class="px-4 py-2 rounded-xl bg-white shadow text-gray-700 border border-gray-200">
                <option>Status</option>
                <option>Completed</option>
                <option>Pending</option>
            </select>
        </div>
        <!-- class="px-5 py-2 bg-emerald-600 text-white font-semibold rounded-xl shadow hover:bg-emerald-700 transition duration-300" -->
        <button command="show-modal" commandfor="dialog"
            class="px-5 py-2 bg-emerald-600 text-white font-semibold rounded-xl shadow hover:bg-emerald-700 transition duration-300">Add
            Purchase
        </button>
        <el-dialog>
            <dialog id="dialog" aria-labelledby="dialog-title"
                class="fixed inset-0 size-auto max-h-auto max-w-auto overflow-y-auto bg-transparent backdrop:bg-transparent">
                <el-dialog-backdrop
                    class="fixed inset-0 bg-gray-500/75 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"></el-dialog-backdrop>

                <div tabindex="0"
                    class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0">
                    <el-dialog-panel
                        class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95">
                        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                            <div class="sm:flex sm:items-start">
                                <div
                                    class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50">
                                    <div
                                        class="bg-white w-full max-w-3xl rounded-3xl shadow-2xl p-8 border border-gray-200">

                                        <h2 class="text-2xl font-bold text-gray-800 mb-6">Add Purchase</h2>

                                        <div class="p-6 max-w-4xl mx-auto bg-white shadow-xl rounded-3xl">
                                            <h2 class="text-2xl font-semibold mb-5">Create Purchase</h2>

                                            <div class="p-6 max-w-4xl mx-auto bg-white shadow-xl rounded-3xl">
                                                <h2 class="text-2xl font-semibold mb-5">Create Purchase</h2>

                                                <form #form="ngForm">
                                                    <!-- Purchase Basic Info -->
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">

                                                        <div>
                                                            <label class="block mb-1 font-medium">Supplier Name</label>
                                                            <select name="supplier" #supplier="ngModel"
                                                                [(ngModel)]="purchased.id"
                                                                class="w-full p-2 border rounded-lg">
                                                                <option value="" disabled>Supplier</option>
                                                                @for (item of suppliers; track $index) {
                                                                <option [value]="item.id">{{item.name}}</option>
                                                                }
                                                            </select>
                                                        </div>

                                                        <div>
                                                            <label class="block mb-1 font-medium">Amount (Grand
                                                                Total)</label>
                                                            <input type="number" [(ngModel)]="purchased.amount"
                                                                class="w-full p-2 border rounded-lg bg-gray-100"
                                                                [value]="overallTotal" name="amount" readonly />
                                                        </div>

                                                        <div>
                                                            <label class="block mb-1 font-medium">Status</label>
                                                            <select class="w-full p-2 border rounded-lg"
                                                                [(ngModel)]="purchased.stat" name="stat">
                                                                <option [ngValue]="Status.Completed">Completed</option>
                                                                <option [ngValue]="Status.Pending">Pending</option>
                                                                <option [ngValue]="Status.Delayed">Delayed</option>
                                                            </select>
                                                        </div>
                                                    </div>



                                                    <!-- PURCHASE ORDERS -->
                                                    <h3 class="text-xl font-semibold mb-3">Purchase Orders</h3>

                                                    <div class="space-y-4">
                                                        @for (order of purchased.purchaseOrders; track $index) {

                                                        <div class="p-4 bg-gray-100 rounded-xl border">

                                                            <div class="grid grid-cols-1 md:grid-cols-5 gap-3">

                                                                <div>
                                                                    <label class="block mb-1 font-medium">Cost
                                                                        Price</label>
                                                                    <input type="number"
                                                                        class="w-full p-2 border rounded-lg"
                                                                        [(ngModel)]="order.costPrice"
                                                                        name="costPrice-{{$index}}"
                                                                        (input)="recalculateTotals()" />
                                                                </div>

                                                                <div>
                                                                    <label
                                                                        class="block mb-1 font-medium">Quantity</label>
                                                                    <input type="number"
                                                                        class="w-full p-2 border rounded-lg"
                                                                        [(ngModel)]="order.quantity"
                                                                        name="quantity-{{$index}}"
                                                                        (input)="recalculateTotals()" />
                                                                </div>

                                                                <div>
                                                                    <label class="block mb-1 font-medium">Product
                                                                        Name</label>
                                                                    <select name="product" #product="ngModel"
                                                                        [(ngModel)]="order.productId"
                                                                        class="w-full p-2 border rounded-lg">
                                                                        <option value="" disabled>Supplier</option>
                                                                        @for (item of productsList; track $index) {
                                                                        <option [value]="item.productId">
                                                                            {{item.productName}}</option>
                                                                        }
                                                                    </select>
                                                                </div>

                                                                <!-- INDIVIDUAL TOTAL -->
                                                                <div>
                                                                    <label class="block mb-1 font-medium">Total</label>
                                                                    <input type="number"
                                                                        class="w-full p-2 border rounded-lg bg-gray-200"
                                                                        [value]="orderTotals[$index]" readonly />
                                                                </div>

                                                                <div class="flex items-end">
                                                                    <button type="button"
                                                                        class="px-4 py-2 bg-red-500 text-white rounded-lg"
                                                                        (click)="removeOrder($index)">
                                                                        Remove
                                                                    </button>
                                                                </div>

                                                            </div>

                                                        </div>

                                                        }
                                                    </div>


                                                    <!-- Add Purchase Order Button -->
                                                    <div class="mt-4">
                                                        <button type="button"
                                                            class="px-4 py-2 bg-blue-600 text-white rounded-lg"
                                                            (click)="addOrder()">
                                                            + Add Purchase Order
                                                        </button>
                                                    </div>
                                                </form>
                                            </div>


                                            <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                                                <button type="button" command="close" commandfor="dialog"
                                                    (click)="addPurchase()"
                                                    class="inline-flex w-full justify-center rounded-md px-3 py-2 text-sm font-semibold text-white shadow-xs sm:ml-3 sm:w-auto  bg-emerald-600 hover:bg-emerald-700 transition duration-300">Add</button>
                                                <button type="button" command="close" commandfor="dialog"
                                                    class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-xs inset-ring inset-ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Cancel</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </el-dialog-panel>
                </div>
            </dialog>
        </el-dialog>

    </div>

    <!-- Summary Cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <div
            class="bg-linear-to-br from-emerald-500 to-emerald-700 text-white p-6 rounded-2xl shadow-xl hover:scale-105 transition duration-300">
            <p class="text-sm text-emerald-100">Total Purchases</p>
            <h2 class="text-3xl font-bold mt-1">GHC 24,580</h2>
        </div>

        <div
            class="bg-linear-to-br from-teal-500 to-teal-700 text-white p-6 rounded-2xl shadow-xl hover:scale-105 transition duration-300">
            <p class="text-sm text-teal-100">Suppliers</p>
            <h2 class="text-3xl font-bold mt-1">{{suppliers.length}}</h2>
        </div>

        <div
            class="bg-linear-to-br from-blue-500 to-blue-700 text-white p-6 rounded-2xl shadow-xl hover:scale-105 transition duration-300">
            <p class="text-sm text-blue-100">Pending Orders</p>
            <h2 class="text-3xl font-bold mt-1">6</h2>
        </div>

        <div
            class="bg-linear-to-br from-amber-500 to-amber-700 text-white p-6 rounded-2xl shadow-xl hover:scale-105 transition duration-300">
            <p class="text-sm text-amber-100">Completed Today</p>
            <h2 class="text-3xl font-bold mt-1">3</h2>
        </div>
    </div>

    <!-- Purchases Table -->
    <div class="bg-white rounded-2xl shadow-xl p-6 border border-emerald-200">
        <h3 class="text-xl font-semibold text-emerald-700 mb-4">Recent Purchases</h3>

        <table class="w-full text-sm">
            <thead class="bg-emerald-50 text-emerald-700">
                <tr class="border-b border-emerald-200 text-left">
                    <th class="py-3">Purchase ID</th>
                    <th class="py-3">Supplier</th>
                    <th class="py-3">Amount</th>
                    <th class="py-3">Date</th>
                    <th class="py-3 text-center">Status</th>
                    <th class="py-3 text-center">Action</th>
                </tr>
            </thead>

            <tbody>
                @for (item of allpurchases; track $index) {
                    
                }
                <tr class="border-b hover:bg-emerald-50/50 transition">
                    <td class="py-3">PUR-0093</td>
                    <td class="py-3">Bright Supplies</td>
                    <td class="py-3 font-semibold text-emerald-700">GHC 2,150</td>
                    <td class="py-3">2025-12-05</td>
                    <td class="py-3 text-center"><span
                            class="px-3 py-1 text-xs rounded-full bg-green-100 text-green-700 font-semibold">Completed</span>
                    </td>
                    <td class="py-3 text-center">
                        <button command="show-modal" commandfor="dialogs"
                            class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-700">View</button>
                        <el-dialog>
                            <dialog id="dialogs" aria-labelledby="dialog-title"
                                class="fixed inset-0 size-auto max-h-none max-w-none overflow-y-auto bg-transparent backdrop:bg-transparent">
                                <el-dialog-backdrop
                                    class="fixed inset-0 bg-gray-500/75 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"></el-dialog-backdrop>

                                <div tabindex="0"
                                    class="flex min-h-full items-end justify-center p-4 text-center focus:outline-none sm:items-center sm:p-0">
                                    <el-dialog-panel
                                        class="relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95">
                                        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                                            <div class="sm:flex sm:items-start">
                                                <div class="p-6 max-w-5xl mx-auto bg-white shadow-xl rounded-3xl">
                                                    <h2 class="text-2xl font-bold mb-6 text-gray-800">Purchase Details
                                                    </h2>

                                                    <!-- PURCHASE SUMMARY -->
                                                    <div
                                                        class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8 p-4 bg-gray-50 rounded-xl border">

                                                        <div>
                                                            <p class="text-gray-500 text-sm">Purchase ID</p>
                                                            <p class="font-semibold text-lg">12</p>
                                                        </div>

                                                        <div>
                                                            <p class="text-gray-500 text-sm">User ID</p>
                                                            <p class="font-semibold text-lg">5</p>
                                                        </div>

                                                        <div>
                                                            <p class="text-gray-500 text-sm">Status</p>
                                                            <span
                                                                class="px-3 py-1 rounded-lg text-sm font-semibold bg-green-200">
                                                                Completed
                                                            </span>
                                                        </div>

                                                        <div>
                                                            <p class="text-gray-500 text-sm">Date</p>
                                                            <p class="font-semibold text-lg">2025-12-11</p>
                                                        </div>

                                                        <div>
                                                            <p class="text-gray-500 text-sm">Grand Total</p>
                                                            <p class="font-semibold text-lg text-green-600">GHS 480</p>
                                                        </div>

                                                    </div>


                                                    <!-- PURCHASE ORDERS -->
                                                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Purchase Orders
                                                    </h3>

                                                    <div class="overflow-x-auto">
                                                        <table
                                                            class="w-full text-left border rounded-xl overflow-hidden">
                                                            <thead class="bg-gray-200 text-gray-700">
                                                                <tr>
                                                                    <th class="p-3 font-semibold">#</th>
                                                                    <th class="p-3 font-semibold">Product ID</th>
                                                                    <th class="p-3 font-semibold">Cost Price</th>
                                                                    <th class="p-3 font-semibold">Quantity</th>
                                                                    <th class="p-3 font-semibold">Total</th>
                                                                </tr>
                                                            </thead>

                                                            <tbody>

                                                                <tr class="border-b hover:bg-gray-50">
                                                                    <td class="p-3">1</td>
                                                                    <td class="p-3">10</td>
                                                                    <td class="p-3">GHS 40</td>
                                                                    <td class="p-3">3</td>
                                                                    <td class="p-3 font-semibold text-green-600">GHS 120
                                                                    </td>
                                                                </tr>

                                                                <tr class="border-b hover:bg-gray-50">
                                                                    <td class="p-3">2</td>
                                                                    <td class="p-3">15</td>
                                                                    <td class="p-3">GHS 60</td>
                                                                    <td class="p-3">5</td>
                                                                    <td class="p-3 font-semibold text-green-600">GHS 300
                                                                    </td>
                                                                </tr>

                                                                <tr class="hover:bg-gray-50">
                                                                    <td class="p-3">3</td>
                                                                    <td class="p-3">20</td>
                                                                    <td class="p-3">GHS 20</td>
                                                                    <td class="p-3">3</td>
                                                                    <td class="p-3 font-semibold text-green-600">GHS 60
                                                                    </td>
                                                                </tr>

                                                            </tbody>
                                                        </table>
                                                    </div>

                                                </div>

                                            </div>
                                        </div>
                                        <div class="bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
                                            <button type="button" command="close" commandfor="dialogs"
                                                class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-xs inset-ring inset-ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto">Cancel</button>
                                        </div>
                                    </el-dialog-panel>
                                </div>
                            </dialog>
                        </el-dialog>

                    </td>
                </tr>


            </tbody>
        </table>
    </div>
</div>


<!-- View Purchase Modal -->
<div id="viewPurchaseModal"
    class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white w-full max-w-lg rounded-2xl shadow-2xl p-6 animate-fade-in">
        <h2 class="text-xl font-semibold text-emerald-700 mb-4">Purchase Details</h2>

        <div class="space-y-3 text-sm">
            <p><strong>Purchase ID:</strong> PUR-0093</p>
            <p><strong>Supplier:</strong> Bright Supplies</p>
            <p><strong>Total Amount:</strong> GHC 2,150</p>
            <p><strong>Date:</strong> 2025-12-05</p>
            <p><strong>Status:</strong> Completed</p>
            <p><strong>Description:</strong> Electronic accessories and hardware tools.</p>
        </div>

        <div class="mt-6 flex justify-end">
            <button onclick="document.getElementById('viewPurchaseModal').classList.add('hidden')"
                class="px-5 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium">Close</button>
        </div>
    </div>
</div>


<!-- Add Purchase Modal -->
<div id="addPurchaseModal"
    class="hidden fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50">
    <div class="bg-white w-full max-w-xl rounded-2xl shadow-2xl p-6 animate-fade-in">
        <h2 class="text-xl font-semibold text-emerald-700 mb-4">Add New Purchase</h2>

        <form class="space-y-4">
            <div>
                <label class="text-sm font-medium text-gray-700">Supplier</label>
                <input type="text" placeholder="Enter supplier name"
                    class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-400" />
            </div>

            <div>
                <label class="text-sm font-medium text-gray-700">Amount (GHC)</label>
                <input type="number" placeholder="Enter amount"
                    class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-400" />
            </div>

            <div>
                <label class="text-sm font-medium text-gray-700">Date</label>
                <input type="date"
                    class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-400" />
            </div>

            <div>
                <label class="text-sm font-medium text-gray-700">Status</label>
                <select class="mt-1 w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-emerald-400">
                    <option>Select status</option>
                    <option>Completed</option>
                    <option>Pending</option>
                    <option>Delayed</option>
                </select>
            </div>

            <div>
                <label class="text-sm font-medium text-gray-700">Description</label>
                <textarea placeholder="Enter purchase details"
                    class="mt-1 w-full px-4 py-2 border rounded-lg h-24 focus:ring-2 focus:ring-emerald-400"></textarea>
            </div>

            <div class="mt-6 flex justify-end gap-3">
                <button type="button" onclick="document.getElementById('addPurchaseModal').classList.add('hidden')"
                    class="px-5 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium">Cancel</button>
                <button
                    class="px-5 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white font-semibold">Save</button>
            </div>
        </form>
    </div>
</div>